<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Nura - Gest√£o Inteligente de Tarefas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../css/TelaPrincipal.css">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>

<body>
  <div class="app-container">
    
    <!-- ===== SIDEBAR ESQUERDA (estilo TickTick) ===== -->
    <aside class="sidebar">
      <!-- Logo/Brand -->
      <div class="sidebar-brand">
        <div class="brand-logo">
          <span class="logo-letter">N</span>
        </div>
        <span class="brand-name">Nura</span>
      </div>

      <!-- User Profile Mini -->
      <div class="sidebar-user">
        <div class="user-avatar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </div>
        <div class="user-info">
          <span class="user-name">Minha Conta</span>
          <span class="user-plan">Plano Free</span>
        </div>
        <button class="btn-upgrade">Pro</button>
      </div>

      <!-- Quick Actions -->
      <div class="sidebar-section">
        <button class="btn-add-task" id="btnNovaGlobal">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Nova Tarefa
        </button>
      </div>

      <!-- Navigation -->
      <nav class="sidebar-nav">
        <a href="#" class="nav-item active">
          <span class="nav-icon">üìÖ</span>
          <span class="nav-text">Hoje</span>
          <span class="nav-badge">3</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">üìÜ</span>
          <span class="nav-text">Pr√≥ximos 7 dias</span>
          <span class="nav-badge">12</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">üì•</span>
          <span class="nav-text">Caixa de Entrada</span>
          <span class="nav-badge">5</span>
        </a>
      </nav>

      <!-- Listas/Projetos -->
      <div class="sidebar-section">
        <div class="section-header">
          <span>Listas</span>
          <button class="btn-icon-sm" onclick="showCreateListModal()" title="Nova Lista">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          </button>
        </div>
        <div class="lists-container">
          <!-- Listas ser√£o carregadas dinamicamente via lists.js -->
        </div>
      </div>

      <!-- Filtros -->
      <div class="sidebar-section">
        <div class="section-header">
          <span>Filtros</span>
        </div>
        <div class="filters-container">
          <a href="#" class="filter-item">
            <span class="filter-dot high"></span>
            <span>Alta Prioridade</span>
          </a>
          <a href="#" class="filter-item">
            <span class="filter-dot medium"></span>
            <span>M√©dia Prioridade</span>
          </a>
          <a href="#" class="filter-item">
            <span class="filter-dot low"></span>
            <span>Baixa Prioridade</span>
          </a>
        </div>
      </div>

      <!-- Etiquetas -->
      <div class="sidebar-section">
        <div class="section-header">
          <span>Etiquetas</span>
        </div>
        <p class="section-hint">Categorize suas tarefas com etiquetas. Selecione rapidamente uma etiqueta digitando "#"</p>
        <div class="tags-container">
          <span class="tag">#urgente</span>
          <span class="tag">#reuni√£o</span>
          <span class="tag">#ideias</span>
        </div>
      </div>

      <!-- Bottom Actions -->
      <div class="sidebar-bottom">
        <a href="#" class="nav-item">
          <span class="nav-icon">‚úÖ</span>
          <span class="nav-text">Conclu√≠do</span>
        </a>
        <a href="#" class="nav-item">
          <span class="nav-icon">üóëÔ∏è</span>
          <span class="nav-text">Lixeira</span>
        </a>
        <a href="Tela_Ajustes.html" class="nav-item">
          <span class="nav-icon">‚öôÔ∏è</span>
          <span class="nav-text">Configura√ß√µes</span>
        </a>
      </div>
    </aside>

    <!-- ===== √ÅREA PRINCIPAL ===== -->
    <main class="main-content">
      
      <!-- Header da p√°gina -->
      <header class="page-header">
        <div class="header-left">
          <button class="btn-menu-mobile" id="menuToggle">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          </button>
          <div class="page-title-group">
            <h1 class="page-title">
              <span class="title-emoji">üëã</span>
              Bem-vindo
            </h1>
            <span class="task-count">11 tarefas</span>
          </div>
        </div>
        <div class="header-right">
          <button class="btn-header" title="Ordenar">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="4" y1="6" x2="20" y2="6"></line>
              <line x1="4" y1="12" x2="14" y2="12"></line>
              <line x1="4" y1="18" x2="8" y2="18"></line>
            </svg>
          </button>
          <button class="btn-header" title="Pesquisar">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
          </button>
          <button class="btn-header" id="darkModeToggle" title="Modo Escuro">
            <svg class="sun-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <svg class="moon-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>
          <button class="btn-header btn-more" title="Mais op√ß√µes">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="1"></circle>
              <circle cx="19" cy="12" r="1"></circle>
              <circle cx="5" cy="12" r="1"></circle>
            </svg>
          </button>
        </div>
      </header>

      <!-- Stats Cards (compacto) -->
      <div class="stats-bar">
        <div class="stat-mini">
          <span class="stat-mini-value" id="tarefas-ativas">5</span>
          <span class="stat-mini-label">Ativas</span>
        </div>
        <div class="stat-mini">
          <span class="stat-mini-value" id="percentual-concluidas">40%</span>
          <span class="stat-mini-label">Conclu√≠das</span>
        </div>
        <div class="stat-mini">
          <span class="stat-mini-value" id="tarefas-andamento">3</span>
          <span class="stat-mini-label">Em Progresso</span>
        </div>
        <div class="stat-mini stat-ai">
          <span class="ai-indicator"></span>
          <span class="stat-mini-label">IA Online</span>
        </div>
      </div>

      <!-- Input de Nova Tarefa (sempre vis√≠vel, estilo TickTick) -->
      <div class="add-task-inline">
        <button class="add-task-trigger" id="btnAdicionar">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          <span>Adicionar tarefa</span>
        </button>
      </div>

      <!-- Bloco expandido de nova tarefa -->
      <div id="blocoTarefas" class="task-input-expanded escondido">
        <textarea id="textareaTarefa" placeholder="O que voc√™ precisa fazer?"></textarea>
        <div class="task-input-toolbar">
          <div class="toolbar-left">
            <button class="toolbar-btn" title="Data">üìÖ</button>
            <button class="toolbar-btn" title="Prioridade">üö©</button>
            <button class="toolbar-btn" title="Lista">üìÅ</button>
            <button class="toolbar-btn" title="Etiqueta">#</button>
          </div>
          <div class="toolbar-right">
            <button class="btn-cancel" id="btnCancelar">Cancelar</button>
            <button class="btn-save" id="btnSalvar">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              Salvar
            </button>
          </div>
        </div>
      </div>

      <!-- Lista de Tarefas com Se√ß√µes Colaps√°veis -->
      <div class="tasks-container" id="listaTarefas">
        <!-- Tarefas ser√£o carregadas dinamicamente do banco de dados -->
      </div>

      <!-- Assistente IA (Floating Card) -->
      <div class="ai-floating-card" id="aiCard">
        <button class="ai-toggle" id="aiToggle">
          <div class="ai-toggle-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2L2 7l10 5 10-5-10-5z"/>
              <path d="M2 17l10 5 10-5"/>
              <path d="M2 12l10 5 10-5"/>
            </svg>
          </div>
          <span>Assistente IA</span>
          <span class="ai-status-dot"></span>
        </button>
        
        <div class="ai-panel" id="aiPanel">
          <div class="ai-panel-header">
            <h3>Gerar Rotina com IA</h3>
            <button class="ai-close" id="aiClose">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          </div>
          <div class="ai-panel-body">
            <div class="ai-field">
              <label>Descreva suas atividades</label>
              <textarea id="descricaoRotina" placeholder="Ex: Revisar relat√≥rios, reuni√£o com equipe..."></textarea>
            </div>
            <div class="ai-time-row">
              <div class="ai-time-field">
                <label>In√≠cio</label>
                <input type="time" id="horaInicioRotina" value="08:00">
              </div>
              <span class="ai-time-arrow">‚Üí</span>
              <div class="ai-time-field">
                <label>T√©rmino</label>
                <input type="time" id="horaFimRotina" value="18:00">
              </div>
            </div>
            <button class="ai-generate-btn" onclick="gerarRotinaInteligente()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
              </svg>
              Gerar Rotina
            </button>
            <div id="resultadoRotina" class="ai-result"></div>
          </div>
        </div>
      </div>

    </main>

  </div>

  <!-- Scripts do Sistema -->
  <script src="../scripts/auth.js"></script>
  <script src="../scripts/settings.js"></script>
  <script src="../scripts/lists.js"></script>
  <script src="../scripts/sincro_telas.js"></script>
  <script src="../scripts/estatisticas_backend.js"></script>
  <script src="../scripts/darkMode.js"></script>

  <!-- Scripts -->
  <script>
    // Toggle sidebar mobile
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.querySelector('.sidebar');
    
    menuToggle?.addEventListener('click', () => {
      sidebar.classList.toggle('open');
    });

    // Toggle se√ß√µes colaps√°veis
    document.querySelectorAll('.section-toggle').forEach(btn => {
      btn.addEventListener('click', () => {
        const section = btn.dataset.section;
        const tasks = document.getElementById(`section-${section}`);
        const chevron = btn.querySelector('.chevron');
        
        tasks.classList.toggle('collapsed');
        chevron.classList.toggle('rotated');
      });
    });

    // Toggle bloco de adicionar tarefa
    const btnAdicionar = document.getElementById('btnAdicionar');
    const btnNovaGlobal = document.getElementById('btnNovaGlobal');
    const blocoTarefas = document.getElementById('blocoTarefas');
    const btnCancelar = document.getElementById('btnCancelar');
    const addTaskTrigger = document.querySelector('.add-task-trigger');

    function showTaskInput() {
      blocoTarefas.classList.remove('escondido');
      blocoTarefas.classList.add('visivel');
      addTaskTrigger?.parentElement.classList.add('hidden');
      document.getElementById('textareaTarefa').focus();
    }

    function hideTaskInput() {
      blocoTarefas.classList.add('escondido');
      blocoTarefas.classList.remove('visivel');
      addTaskTrigger?.parentElement.classList.remove('hidden');
    }

    btnAdicionar?.addEventListener('click', showTaskInput);
    btnNovaGlobal?.addEventListener('click', showTaskInput);
    btnCancelar?.addEventListener('click', hideTaskInput);

    // Toggle AI Panel
    const aiToggle = document.getElementById('aiToggle');
    const aiPanel = document.getElementById('aiPanel');
    const aiClose = document.getElementById('aiClose');
    const aiCard = document.getElementById('aiCard');

    aiToggle?.addEventListener('click', () => {
      aiCard.classList.toggle('expanded');
    });

    aiClose?.addEventListener('click', () => {
      aiCard.classList.remove('expanded');
    });

    // Dark mode gerenciado por darkMode.js

    // Checkbox toggle - integrado com sistema de tarefas
    document.addEventListener('click', function(e) {
      // Delegar evento para checkboxes din√¢micas
      if (e.target.closest('.task-checkbox input')) {
        const checkbox = e.target;
        const taskItem = checkbox.closest('.task-item');
        const taskId = taskItem?.dataset.taskId;

        if (taskId) {
          // Usar fun√ß√£o do sincro_telas.js
          if (typeof toggleTaskFromHome === 'function') {
            toggleTaskFromHome(parseInt(taskId));
          }
        } else {
          // Tarefas est√°ticas (tutorial)
          taskItem.classList.toggle('completed', checkbox.checked);
        }
      }
    });

    // Atualizar contadores ap√≥s carregar tarefas
    window.addEventListener('load', () => {
      if (typeof atualizarEstatisticas === 'function') {
        atualizarEstatisticas();
      }
    });
  </script>
</body>

</html>